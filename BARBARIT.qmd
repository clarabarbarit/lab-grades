---
title: "BARBARIT"
format: html
---

```{r, message=FALSE, warning=FALSE}
here::i_am("lab-grades.Rproj")
library(here)
library(tidyr)
library(ggplot2)
library(dplyr)
library(vroom)
```

```{r, message=FALSE, warning=FALSE}
courses <- vroom(here("data","courses.csv"))
```


```{r, message=FALSE, warning=FALSE}
courses |>
  rename(
    "course name" = course,
    "identifier" = course_id,
    "module" = module,
    "number of exams" = nb_grades
  ) |>
  arrange(`course name`) |>
  knitr::kable()
```

```{r, message=FALSE, warning=FALSE}
students <- vroom(here("data","students.csv"),
                  col_types = cols(
                       id = col_integer(),
                       group = col_factor(),
                       birth_date = col_date(),
                       sex = col_factor()
                     ))
```

The birth_date column of the students data frame is of class `r class(students$birth_date)`

The sex column of the students data frame is of class `r class(students$sex)`


```{r, message=FALSE, warning=FALSE}
library(readr)

grades <- read_delim(here("Data", "grades.csv"),
  delim = "|",
  na = "*",
  col_types = cols(
    id = col_integer(),
    course_id = col_integer(),
    grade = col_double()
  )
)
```

```{r, message=FALSE, warning=FALSE}
students |> 
  group_by(group) |>
  summarise(n = n())|>
  ggplot(aes(x = group, y = n)) +
  geom_col() +
  theme_minimal()+
  labs(title = "Number of Students per Group",
       y = "Count")
```

```{r, message=FALSE, warning=FALSE}
students |>
  group_by(group, sex) |>
  summarise(n = n(), .groups = "drop") |>
  ggplot(aes(x = group, y = n, fill = sex)) +
  geom_col(position = "fill") +
  labs(title = "Gender Balance per Group",
       y = "Proportion")
```

```{r, message=FALSE, warning=FALSE}
library(lubridate)

students |>
  mutate(age = time_length(today() - birth_date, unit="year")) |>
  ggplot(aes(x = age)) +
  geom_histogram(bins = 20) +
  theme_minimal()+
  labs(title = "Distribution of Student Ages")
```

